<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸»é¢˜åˆ‡æ¢æµ‹è¯•</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }

        // Theme initialization script (same as in index.html)
        (function() {
            try {
                const stored = localStorage.getItem('ainiee_ui_prefs_v1');
                const prefs = stored ? JSON.parse(stored) : null;
                const mode = prefs?.themeMode || 'light';

                let effectiveTheme = mode;
                if (mode === 'system') {
                    effectiveTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
                }

                document.documentElement.classList.remove('light', 'dark');
                document.documentElement.classList.add(effectiveTheme);
                console.log('Initial theme applied:', effectiveTheme);
            } catch (e) {
                console.error('Theme initialization error:', e);
                document.documentElement.classList.add('light');
            }
        })();
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .theme-transition {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }
    </style>
</head>
<body class="theme-transition bg-white dark:bg-slate-900 text-slate-900 dark:text-slate-100 min-h-screen p-8">
    <div class="max-w-4xl mx-auto space-y-8">
        <!-- Header -->
        <div class="text-center space-y-4">
            <h1 class="text-4xl font-bold">ä¸»é¢˜åˆ‡æ¢æµ‹è¯•é¡µé¢</h1>
            <p class="text-slate-600 dark:text-slate-400">éªŒè¯ä¸»é¢˜ç³»ç»Ÿæ˜¯å¦æ­£å¸¸å·¥ä½œ</p>
        </div>

        <!-- Current Theme Display -->
        <div class="bg-slate-100 dark:bg-slate-800 rounded-xl p-6 border-2 border-slate-200 dark:border-slate-700">
            <h2 class="text-lg font-semibold mb-4">å½“å‰çŠ¶æ€</h2>
            <div class="space-y-2 font-mono text-sm">
                <div class="flex justify-between">
                    <span class="text-slate-600 dark:text-slate-400">HTML Classes:</span>
                    <span id="htmlClasses" class="text-primary font-bold">-</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-slate-600 dark:text-slate-400">Local Storage:</span>
                    <span id="localStorage" class="text-primary font-bold">-</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-slate-600 dark:text-slate-400">System Preference:</span>
                    <span id="systemPref" class="text-primary font-bold">-</span>
                </div>
            </div>
        </div>

        <!-- Theme Controls -->
        <div class="bg-slate-100 dark:bg-slate-800 rounded-xl p-6 border-2 border-slate-200 dark:border-slate-700">
            <h2 class="text-lg font-semibold mb-4">ä¸»é¢˜æ§åˆ¶</h2>
            <div class="flex gap-4">
                <button onclick="setTheme('light')" class="px-6 py-3 bg-white dark:bg-slate-700 text-slate-900 dark:text-white rounded-lg border-2 border-slate-200 dark:border-slate-600 hover:border-primary font-medium transition-all">
                    â˜€ï¸ Light
                </button>
                <button onclick="setTheme('dark')" class="px-6 py-3 bg-white dark:bg-slate-700 text-slate-900 dark:text-white rounded-lg border-2 border-slate-200 dark:border-slate-600 hover:border-primary font-medium transition-all">
                    ğŸŒ™ Dark
                </button>
                <button onclick="setTheme('system')" class="px-6 py-3 bg-white dark:bg-slate-700 text-slate-900 dark:text-white rounded-lg border-2 border-slate-200 dark:border-slate-600 hover:border-primary font-medium transition-all">
                    ğŸ’» System
                </button>
            </div>
        </div>

        <!-- Color Samples -->
        <div class="bg-slate-100 dark:bg-slate-800 rounded-xl p-6 border-2 border-slate-200 dark:border-slate-700">
            <h2 class="text-lg font-semibold mb-4">é¢œè‰²æ ·æœ¬</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div class="space-y-2">
                    <div class="h-20 bg-primary rounded-lg"></div>
                    <p class="text-xs text-center">Primary</p>
                </div>
                <div class="space-y-2">
                    <div class="h-20 bg-accent rounded-lg"></div>
                    <p class="text-xs text-center">Accent</p>
                </div>
                <div class="space-y-2">
                    <div class="h-20 bg-secondary rounded-lg"></div>
                    <p class="text-xs text-center">Secondary</p>
                </div>
                <div class="space-y-2">
                    <div class="h-20 bg-destructive rounded-lg"></div>
                    <p class="text-xs text-center">Destructive</p>
                </div>
            </div>
        </div>

        <!-- UI Elements -->
        <div class="bg-slate-100 dark:bg-slate-800 rounded-xl p-6 border-2 border-slate-200 dark:border-slate-700">
            <h2 class="text-lg font-semibold mb-4">UI å…ƒç´ æµ‹è¯•</h2>
            <div class="space-y-4">
                <!-- Card -->
                <div class="bg-card text-card-foreground border border-border rounded-lg p-4">
                    <h3 class="font-semibold mb-2">å¡ç‰‡æ ‡é¢˜</h3>
                    <p class="text-muted-foreground text-sm">è¿™æ˜¯å¡ç‰‡å†…å®¹ï¼Œæµ‹è¯•èƒŒæ™¯å’Œæ–‡å­—é¢œè‰²ã€‚</p>
                </div>

                <!-- Button Group -->
                <div class="flex gap-2">
                    <button class="px-4 py-2 bg-primary text-primary-foreground rounded-lg">Primary Button</button>
                    <button class="px-4 py-2 bg-secondary text-secondary-foreground rounded-lg">Secondary Button</button>
                    <button class="px-4 py-2 bg-accent text-accent-foreground rounded-lg">Accent Button</button>
                </div>

                <!-- Input -->
                <div>
                    <label class="block text-sm font-medium mb-2">è¾“å…¥æ¡†</label>
                    <input type="text" placeholder="Type here..." class="w-full px-4 py-2 bg-background border border-input rounded-lg focus:ring-2 focus:ring-ring focus:border-transparent">
                </div>
            </div>
        </div>

        <!-- Debug Console -->
        <div class="bg-slate-100 dark:bg-slate-800 rounded-xl p-6 border-2 border-slate-200 dark:border-slate-700">
            <h2 class="text-lg font-semibold mb-4">è°ƒè¯•æ§åˆ¶å°</h2>
            <div class="space-y-2">
                <button onclick="clearStorage()" class="px-4 py-2 bg-destructive text-destructive-foreground rounded-lg text-sm">
                    ğŸ—‘ï¸ æ¸…é™¤ LocalStorage å¹¶åˆ·æ–°
                </button>
                <button onclick="checkCSSVars()" class="px-4 py-2 bg-slate-200 dark:bg-slate-700 rounded-lg text-sm">
                    ğŸ” æ£€æŸ¥ CSS å˜é‡
                </button>
                <div id="console" class="mt-4 font-mono text-xs bg-black text-green-400 rounded-lg p-4 max-h-40 overflow-y-auto">
                    <div>> Console ready</div>
                </div>
            </div>
        </div>

        <!-- Instructions -->
        <div class="bg-blue-50 dark:bg-blue-900/20 rounded-xl p-6 border-2 border-blue-200 dark:border-blue-800">
            <h2 class="text-lg font-semibold mb-4 text-blue-900 dark:text-blue-100">ğŸ“‹ æµ‹è¯•æ­¥éª¤</h2>
            <ol class="list-decimal list-inside space-y-2 text-blue-800 dark:text-blue-200 text-sm">
                <li>ç‚¹å‡»ä¸Šæ–¹çš„ä¸»é¢˜æŒ‰é’®åˆ‡æ¢ä¸»é¢˜</li>
                <li>è§‚å¯Ÿé¡µé¢é¢œè‰²æ˜¯å¦æ­£ç¡®åˆ‡æ¢</li>
                <li>æ£€æŸ¥"å½“å‰çŠ¶æ€"åŒºåŸŸçš„ä¿¡æ¯æ˜¯å¦æ­£ç¡®</li>
                <li>åˆ·æ–°é¡µé¢ï¼ŒéªŒè¯ä¸»é¢˜æ˜¯å¦æŒä¹…åŒ–</li>
                <li>æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å° (F12) æŸ¥çœ‹æ—¥å¿—</li>
            </ol>
        </div>
    </div>

    <script>
        // Update status display
        function updateStatus() {
            document.getElementById('htmlClasses').textContent = document.documentElement.className || 'none';

            const stored = localStorage.getItem('ainiee_ui_prefs_v1');
            try {
                const prefs = stored ? JSON.parse(stored) : null;
                document.getElementById('localStorage').textContent = prefs ? prefs.themeMode : 'not set';
            } catch (e) {
                document.getElementById('localStorage').textContent = 'error';
            }

            const systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            document.getElementById('systemPref').textContent = systemDark ? 'dark' : 'light';
        }

        // Set theme
        function setTheme(mode) {
            try {
                // Update localStorage
                const prefs = {
                    themeMode: mode,
                    updatedAt: Date.now()
                };
                localStorage.setItem('ainiee_ui_prefs_v1', JSON.stringify(prefs));

                // Calculate effective theme
                let effectiveTheme = mode;
                if (mode === 'system') {
                    effectiveTheme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
                }

                // Apply to DOM
                document.documentElement.classList.remove('light', 'dark');
                document.documentElement.classList.add(effectiveTheme);

                log(`Theme changed to: ${mode} (effective: ${effectiveTheme})`);
                updateStatus();
            } catch (e) {
                log('Error setting theme: ' + e.message, 'error');
            }
        }

        // Clear storage
        function clearStorage() {
            localStorage.removeItem('ainiee_ui_prefs_v1');
            log('LocalStorage cleared, reloading...');
            setTimeout(() => location.reload(), 500);
        }

        // Check CSS variables
        function checkCSSVars() {
            const styles = getComputedStyle(document.documentElement);
            const vars = ['--background', '--foreground', '--primary', '--accent', '--secondary'];
            vars.forEach(v => {
                const value = styles.getPropertyValue(v).trim();
                log(`${v}: ${value}`);
            });
        }

        // Console log
        function log(message, type = 'info') {
            const consoleDiv = document.getElementById('console');
            const line = document.createElement('div');
            line.textContent = `> ${message}`;
            if (type === 'error') {
                line.style.color = '#f87171';
            }
            consoleDiv.appendChild(line);
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        }

        // Initial update
        updateStatus();

        // Listen for system theme changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
            log(`System preference changed to: ${e.matches ? 'dark' : 'light'}`);
            updateStatus();

            // Re-apply if in system mode
            const stored = localStorage.getItem('ainiee_ui_prefs_v1');
            if (stored) {
                const prefs = JSON.parse(stored);
                if (prefs.themeMode === 'system') {
                    setTheme('system');
                }
            }
        });

        log('Test page loaded successfully');
    </script>
</body>
</html>
